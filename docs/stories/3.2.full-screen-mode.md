# Story 3.2: Full-Screen Mode

## Status
Draft

## Story
**As a** user,  
**I want** to toggle a full-screen mode for the video feed,  
**so that** I can have a more immersive and unobstructed view while flying.

## Acceptance Criteria
1. A "full-screen" icon or button is displayed on the UI.
2. Clicking the button expands the web application's video element to fill the entire screen, hiding browser UI elements.
3. All UI overlays (status bar, controls) remain functional and scale appropriately in full-screen mode.
4. Clicking the button again (or pressing the 'Esc' key) exits full-screen mode and returns the view to its standard layout.

## Tasks / Subtasks
- [ ] Create FullScreenControl component for UI button (AC: 1)
  - [ ] Create packages/web/src/components/FullScreenControl.tsx component
  - [ ] Implement full-screen icon button with proper styling using Tailwind CSS
  - [ ] Add visual feedback to indicate current mode (normal/full-screen)
  - [ ] Handle click events to toggle full-screen mode
- [ ] Implement full-screen functionality using Fullscreen API (AC: 2, 4)
  - [ ] Create custom hook useFullscreen.ts in packages/web/src/hooks/
  - [ ] Implement Document.documentElement.requestFullscreen() for entering full-screen
  - [ ] Implement Document.exitFullscreen() for exiting full-screen
  - [ ] Handle fullscreenchange events to track current state
  - [ ] Handle Escape key events for exiting full-screen mode
- [ ] Ensure UI overlays remain functional in full-screen mode (AC: 3)
  - [ ] Update VideoPlayer component to handle full-screen state changes
  - [ ] Ensure flight controls (FlightControls, MovementControls, CameraSwitchControl) scale appropriately
  - [ ] Test telemetry status display visibility and functionality in full-screen
  - [ ] Ensure all buttons remain clickable and properly positioned
- [ ] Integrate FullScreenControl component into main application layout (AC: 1)
  - [ ] Add FullScreenControl component to packages/web/src/App.tsx
  - [ ] Position full-screen button appropriately with existing UI controls
  - [ ] Ensure responsive design with existing UI components
  - [ ] Test full-screen toggle functionality across different screen sizes
- [ ] Add comprehensive testing
  - [ ] Test FullScreenControl component with click events and state changes
  - [ ] Test useFullscreen hook functionality with mocked Fullscreen API
  - [ ] Test keyboard event handling (Escape key)
  - [ ] Test UI scaling and positioning in full-screen mode
  - [ ] Test full-screen functionality across different browsers and devices

## Dev Notes

### Previous Story Insights
[Source: docs/stories/3.1.camera-switching.md - Dev Agent Records]
- **React Component Architecture**: Proven component-based React architecture established with CameraSwitchControl, FlightControls, and MovementControls patterns for new FullScreenControl component
- **Custom Hook Pattern**: useDroneSocket.ts pattern proven for specialized functionality - create useFullscreen.ts hook for full-screen state management
- **Tailwind CSS Integration**: Tailwind CSS 3.4.3 styling system proven working for button components with visual feedback patterns
- **App.tsx Integration**: Pattern established for integrating new control components alongside existing UI elements
- **Testing Strategy**: Vitest (frontend) with comprehensive mocking proven working for component and hook testing

### Data Models and Types
[Source: architecture/4-data-models.md]
- **No New Command Types Required**: Full-screen mode is purely a frontend functionality using browser Fullscreen API - no WebSocket communication or ControlCommand types needed
- **Local State Management**: Full-screen state will be managed locally in React component state, no backend integration required
- **Type Safety**: TypeScript interfaces for Fullscreen API methods and events (requestFullscreen, exitFullscreen, fullscreenchange)

### Component Specifications  
[Source: architecture/5-components.md]
- **Frontend Web App (web package)**: Responsible for all user interface including full-screen functionality - captures full-screen button clicks and manages browser full-screen state via Fullscreen API
- **No Backend Changes**: Full-screen mode is entirely frontend functionality - no modifications needed to backend server or WebSocket endpoints
- **Pure UI Feature**: Unlike flight controls, full-screen mode doesn't involve drone communication, only browser API interaction

### Core Workflow Integration
[Source: architecture/7-core-workflows.md]
- **Full-Screen Toggle Flow Pattern**: User → Button Click → Frontend → Fullscreen API → Browser Full-Screen → UI Scaling
- **No WebSocket Communication**: This feature operates independently of drone communication workflows
- **UI State Management**: Frontend manages full-screen state locally and updates UI components accordingly

### File Locations and Structure
[Source: architecture/9-source-tree.md & previous implementations]
- **Frontend Components**: 
  - packages/web/src/components/FullScreenControl.tsx (new full-screen toggle button component)
  - packages/web/src/hooks/useFullscreen.ts (new custom hook for full-screen state management)
- **App Integration**: packages/web/src/App.tsx (integrate FullScreenControl component)
- **VideoPlayer Enhancement**: packages/web/src/components/VideoPlayer.tsx (may need updates for full-screen scaling)

### Coding Standards
[Source: architecture/12-coding-standards.md]
- **Components**: PascalCase (FullScreenControl.tsx)
- **Hooks**: camelCase with use prefix (useFullscreen.ts)
- **Type Safety**: All full-screen API interactions MUST use proper TypeScript types for Document.requestFullscreen(), Document.exitFullscreen()
- **Critical Rule**: Frontend-only feature - no backend or drone API interaction required
- **Naming**: Follow established patterns from existing components (CameraSwitchControl, FlightControls)

### Testing Strategy
[Source: architecture/13-test-strategy-and-standards.md]
- **Frontend Testing**: Vitest with mocked Fullscreen API methods for full-screen functionality testing
- **File Convention**: [filename].test.tsx co-located with source files
- **Mocking Requirements**: Mock Document.requestFullscreen(), Document.exitFullscreen(), fullscreenchange events, keyboard events
- **Test Focus**: Full-screen toggle functionality, button click handling, visual feedback, keyboard event handling (Escape key), UI scaling validation

### Tech Stack Requirements
[Source: architecture/3-tech-stack.md]
- **Frontend Framework**: React 18.3.1 with component-based architecture for full-screen control component
- **Styling**: Tailwind CSS 3.4.3 - for full-screen button styling and visual feedback
- **Language**: TypeScript 5.4.5 - strict mode for type safety in Fullscreen API interactions
- **Build Tool**: Vite 5.2.0 - for frontend development and testing

### Technical Implementation Notes
- **Fullscreen API Usage**: Use Document.documentElement.requestFullscreen() to enter full-screen mode
- **Exit Full-Screen**: Use Document.exitFullscreen() and handle 'Esc' key events
- **State Tracking**: Listen to 'fullscreenchange' events to track current full-screen state
- **Visual Design**: Clear full-screen icon/button with visual indication of current mode (normal/full-screen)
- **Button Integration**: Position full-screen control appropriately within existing UI layout
- **UI Scaling**: Ensure all UI overlays (status, controls) remain functional and properly scaled in full-screen mode
- **Cross-Browser Compatibility**: Handle vendor prefixes if needed for Fullscreen API support

### Integration with Existing Components
- **VideoPlayer Component**: May need updates to handle full-screen mode scaling and positioning
- **UI Layout**: Build on established component layout patterns from App.tsx
- **Existing Controls**: Ensure FlightControls, MovementControls, and CameraSwitchControl remain functional in full-screen mode
- **Responsive Design**: Follow established Tailwind CSS patterns for responsive UI scaling

## Testing

### Testing Standards
[Source: architecture/13-test-strategy-and-standards.md]
- **Test Location**: Co-locate test files with source files using .test.tsx extension
- **Frontend Framework**: Vitest for testing FullScreenControl component and useFullscreen hook
- **Mocking Strategy**: Mock all Fullscreen API methods (requestFullscreen, exitFullscreen, fullscreenchange events, keyboard events)
- **Test Data**: Hardcode test data directly in test files (full-screen states, button states)
- **Coverage Focus**: Test full-screen toggle functionality, button click handling, visual feedback, keyboard event handling, UI state management

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-07-31 | 1.0 | Initial story creation | Bob (Scrum Master) |